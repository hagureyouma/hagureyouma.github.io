# UnrealTournament99のマップ作ろうね

By MYAO

MYAO(C)2025 All right reserved.

UT99のマップ制作の解説ページだよ

自分だけのマップを作りまくろう

## はじめに

このページの解説はエディターの使い方に絞っており、マップのゲームプレイ上のことやゲームバランスなどに関しては割愛します。
（私自身がBotと遊んでるかシングルプレイヤー専門のエンジョイ勢で、対戦に関しては詳しくなくて語れません…）

<u>Q.マップ制作の情報がもっとほしい</u>

日本語の解説はほぼ無いけれど海外のサイトには情報が結構充実していて、Google翻訳で普通に読める。

beyondunrealwiki.github.io マップ制作Wiki　

UnrealEDの情報を検索するとフォーラムがよくヒットする海外のコミュニティサイト。
- ut99.org
- oldunreal.com
- unrealsp.org（サイトの仕様なのかGoogle翻訳でページ全体の翻訳ができないようなので、Webブラウザの選択したテキストを翻訳できる拡張機能とか使おう）

## 作る前に

マップを作るには付属のUnreal Editor（以下UnrealED）を使います。
UTのSystemsフォルダーにあるunrealed.exeがUnrealEDです。

### 最新のパッチを適用しよう
oldunreal.comのパッチを適用すると、UnrealEDが大幅にパワーアップします
パッチはここ https://github.com/OldUnreal/UnrealTournamentPatches/releases
OSにあったファイルをダウンロードしよう
- MacやLinux版もある
このページの解説はOldunrealのパッチを適用していることが前提になります

### ホットキーの設定

よく使う操作はホットキーに設定してボタン一つで実行できるようにすると楽
Tool→Advanced OptionsのAdvanced→Raw Key Bindingsでキーにコマンドを設定できる
主なコマンドはここに載ってる https://beyondunrealwiki.github.io/pages/unrealed-2-console.html

コマンドの例

- MODE CAMERAMOVE　カメラ移動ツールに切り替え
- MODE VERTEXEDIT　頂点編集ツールに切り替え
- ACTOR DUPLICATE　アクターの複製

### カスタムボタン

UnrealEDに便利ボタンを追加できます
ここにいろいろある
https://darkrealm.333networks.com/index.php?dir=Deus%20Ex/UEditor%20Developing/Ued2Buttons/
https://f.ulut.in/viewtopic.php?t=979
これのRahnemBrushBuilderのLandscape Builderは自然の地形を作るのに役立つ

Editor Tools
https://ut99.org/viewtopic.php?t=14061

## マップ制作の基本

制作の流れ

部屋を作る→照明を置く→リスポーン地点やアイテムを置く→Botが辿るルートを設定→プレイ！

- マップを見た目を作り込んだ後から変更するのは大変なので、先にマップの大雑把な構造だけ作ってテストプレイできるようにして、遊んでみて良い感じだったら、それから見た目を作り込もう

## マップ制作のポイント

#### グループを活用しよう

- 例えば、同じ色のライトをグループにしておくと、後から色を変えたくなった時に一発でライトを選択でき、ライトを一つ一つ探してクリックする手間がなくなります。
- マップのエリアの区切りが良い部分のアクターをグループにしておくと、そこだけ表示したり非表示にしたりでき、ビルドのOnly Rebuild Visible Actorsオプションで部分的にビルドするのがやりやすくなります。

- グループにするアクターをすべて選択して、Group BrowserのNew Groupでグループ作成。任意のグループ名をつけられる。
- 後から追加するにはAdd Selected Actor to Group
- グループから削除するにはDelete Selected Actor to Group
- グループのアクターを選択するにはSelect Actor in Group
- 選択中のアクターからグループのアクターの選択を解除はDeselect Actor in Group



## マップの地形を作る

**ブラシ**と言うポリゴンの箱のようなものを置いていってマップを作ります
- ブラシの集まりはジオメトリとも呼ばれます

### ブラシの種類
色はPerspectiveモードで表示される枠の色

- Subtruct（減算）黄色　空間を作る
- Add（加算）青　空間を埋める
- Semi-Solid（半固体）当たり判定がある装飾
- Non-Solid（非固体）当たり判定がない装飾と、空間の仕切り

### ブラシを置く
Cubeなどでビルダーブラシを必要な形状にするか、または既存のブラシをDuplicateで複製して、必要ならVertex Editingツールで変形したら、Camera Movementツールを選択して、ブラシをShift（画面をスクロールする）またはCtrl（スクロールしない）＋ドラッグで移動、ビルダーブラシの場合はSubtractやAddで配置。ビルドすると反映される。

#### ブラシを一つにまとめる
まとめるブラシ群をビルダーブラシで囲って、SubtructならIntersect、AddならDeintersectで、ビルダーブラシがそのブラシ群の形になる
主に複雑な形状のMoverを作るためと、複数のブラシでできた装飾などを扱いやすくする制作の利便性のためのもの。マップの重さには影響しないと思われる
あまり大きなSubtructはまとめないほうが良いかもしれない

置いたブラシを後からまとめる方法
一つにまとめたいブラシと、Addならそれが入っているSubtructを選択→Invert Selection→Hide Selected Actors→Build→ビルダーブラシで囲ってまとめる→元のブラシを削除→AddまたはSubtruct→Show All Actors

### ポリゴンのマージ
ブラシの分割されている平面を一つの面にする
マージしたブラシをクリッピングや頂点編集などする場合は、事前に必ずセパレートしてからにしよう。でないとBSPエラーが起きるかも。

#### Transform Pemamntly（恒久的に変換）
ブラシの現在の変形や回転を基準として適用する。基本的にはやらなくていい
回転方向がおかしい、ブラシのクリッピングが上手く行かない、BSPエラーが起きた、などの場合に使う

### Polygons→Snap vertex to grid
頂点を最寄りのグリッドにスナップする。回転して頂点がグリッドからズレたブラシをスナップしたいときに。BSPエラーを減らせるかもしれない。

### 半固体ブラシの活用法



 <u>Q.マップに四角い穴が空いたり、見えない当たり判定が現れた！なにこれ</u>

BSPエラーが起きてる。
BSP（バイナリ空間分割）はUE1のマップに採用されているデータ構造のことで、それがどこかおかしくなって表示がバグってます。
- BSPエラーの原因は、主に浮動小数点誤差の蓄積によると思われる。

Build Geometryだと大丈夫なのにBuild Allだと起きることもある。

#### 予防
- ブラシの頂点をかならずグリッドにスナップする
- ブラシの表面をマージする
- 半固体ブラシを活用する
- ゾーンを確実に区切る

#### 対処法
- エラーが起きてるあたりの減算ブラシのorder（順序）をto First（最初）にしてビルド。これでだいたい治る。
- エラーが起きてるブラシを作り直す
- 半固体ブラシに非固体ブラシが重なっていたら重なりを解消する

<u>Q.ZoneInfoを水の中においたはずなのに部屋全体が水没してます</u>

- 本当に空間が閉じているか再確認。半固体ブラシは空間を閉じないので注意
- 空間を閉じているブラシを、マージしてから頂点編集やクリッピングしてない？していた場合は一旦セパレートして改めてマージしよう。

## テクスチャー


**重要：** unrealtournament.iniの[Editor.EditorEngine]にTextureLock=trueを追加すると、頂点編集や恒久的に変換を行ってもテクスチャーのアラインメントが保持される

- 面をAlt＋右クリックでスポイト、Alt＋クリックで適用
- 未使用のテクスチャーを削除　コマンドに「Texture Cull」と入力　最後の仕上げに。
### 選択
Shift+B　選択した面があるブラシのすべての面
Shift+T　選択した面のテクスチャーが設定されているすべての面

### 位置合わせ
Auto、または床はAlign toFloor、側面はWallXY、X、Yを使うと整列しやすい

#### 斜面
SurfaceプロパティのAutoでだいたいいける
向きが思い通りじゃない場合は、Wall direction→Scalingで縦横比を指定してPanで合わせる
対角線の長さ→縦×2+横×2の√を2で割る
- 1:1 1.4142135623730951
- 1:2 1.118033988749895

## マップの特別なもの

<u>Q.あのマップで見たあれを作りたい</u>

そのマップをUnrealEDで開いてどうやっているか調べよう

### 水

Zone Portalで水面を作る
水のテクスチャーは、Liquid.utx、rainFX.utxなどにある
### リフト、エレベーター
### 空

## パス
PlayerstartのOderをLastにする　469でも必要かは不明

## マップにスクリーンショットをつける
マップ選択画面に**スクリーンショット**が表示されるようにしよ
- スクリーンショットを設定すると、LevelInfoのマップ名や推奨プレイヤー人数が表示されます

スクリーンショットに使える画像は、256×256ピクセルで256色のBMPまたはPCX形式になります

1. 撮影準備
   - Botを0人にしてPlayer SetupでSpectator（観客モード）にして撮るのが簡単
   - Spectarorを使わない場合は、HUDと照準を写り込まないよう非表示にしよう
2. F9キーでUTの機能でスクリーンショット撮影できる。保存先はUTのSystemフォルダ
    - 実際の画面より暗くなるかもしれない？
    Nvidiaオーバーレイなどのキャプチャアプリの機能で撮影するほうがいいかもね

3. 正方形にトリミングする
　　- Windows付属のフォトできる
4. 256×256ピクセルに縮小して、256色に減色する
  - 縮小と減色は例えば[藤リサイザー](https://www.vector.co.jp/soft/winnt/art/se132646.html)とかで。ファイル名の生成規則の拡張子をbmp8のすると256色にできる
5. UnrealEDのTexturesでインポート、PackageはMyLevelを選び、GroupはNone、名前はScreenshotにして、Gen Mipmapsのチェックを**オフ**にする。
**注！MyLevelパッケージは保存する必要はありません。というより保存するとエラーが起きるそうです。（469パッチだと修正が入ってるかもだけど未確認）**
6. スクリーンショットのテクスチャーを選択して、Level PropertiesのLevelInfo→ScreenshotのUseボタンをクリックする
7. Practice Sessionで確認しよう

### マップ制作の所感